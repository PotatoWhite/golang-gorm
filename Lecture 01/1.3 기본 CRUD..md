### 1.3 기본 CRUD

GORM에서 기본적인 데이터베이스 작업인 **CRUD(Create, Read, Update, Delete)**를 처리하는 방법을 정리합니다. 이 단원에서는 주요 메서드와 예제를 통해 CRUD 작업을 설명하며, 각 메서드의 내부 동작 및 활용법에 대한 추가적인 설명을 포함합니다.

---

#### 1.3.1 Create (생성)

- **새 데이터 삽입**: `Create` 메서드는 단일 또는 다수의 레코드 삽입을 지원합니다.
- **주의 사항**:
  - 생성 시 구조체의 필드 중 `gorm:"-"`가 설정된 필드는 삽입되지 않습니다.
  - 기본 키 필드가 비어 있는 경우, 데이터베이스에 따라 자동으로 값이 생성될 수 있습니다.
- **예제**:
  ```go
  type User struct {
      ID   uint   `gorm:"primaryKey"`
      Name string
      Age  int
  }

  func main() {
      db, err := gorm.Open(mysql.Open(dsn), &gorm.Config{})
      if err != nil {
          panic("DB 연결 실패")
      }

      // 테이블 자동 생성
      db.AutoMigrate(&User{})

      // 데이터 생성
      user := User{Name: "Alice", Age: 25}
      result := db.Create(&user) // INSERT INTO users (name, age) VALUES ("Alice", 25)
      if result.Error != nil {
          fmt.Println("생성 오류:", result.Error)
      } else {
          fmt.Println("새 유저 ID:", user.ID)
      }
  }
  ```

---

#### 1.3.2 Read (조회)

- **단일 데이터 조회**:
  - `db.First(&model)` : 첫 번째 레코드 조회 (오름차순)
  - `db.Last(&model)` : 마지막 레코드 조회 (내림차순)
- **다중 데이터 조회**:
  - `Find` 메서드는 조건에 맞는 모든 레코드를 반환합니다.
- **조건부 데이터 조회**:
  - `Where` 메서드를 통해 필터 조건을 지정할 수 있습니다.
  - SQL Injection 방지를 위해 플레이스홀더(`?`)를 사용하는 것이 좋습니다.
- **예제**:
  ```go
  var user User
  db.First(&user) // SELECT * FROM users ORDER BY id LIMIT 1
  fmt.Println("유저 조회:", user)

  var users []User
  db.Where("age > ?", 20).Find(&users) // SELECT * FROM users WHERE age > 20
  fmt.Println("20세 이상 유저:", users)
  ```
- **추가 옵션**:
  - `Select`로 특정 필드만 선택 가능.
  - `Order`와 `Limit`으로 정렬과 개수 제한 가능.

---

#### 1.3.3 Update (갱신)

- **단일 데이터 수정**:
  - `Save` 메서드는 모든 필드를 업데이트합니다.
  - 수정되지 않은 필드도 기본값으로 덮어씌워질 위험이 있으니 주의해야 합니다.
- **특정 컬럼 수정**:
  - `Update` 메서드는 단일 컬럼만 갱신.
  - `Updates` 메서드는 다중 컬럼을 갱신합니다.
- **조건부 수정**:
  - `Model`과 `Where` 메서드를 함께 사용하여 조건부 업데이트가 가능합니다.
- **예제**:
  ```go
  db.First(&user, 1) // ID 1 조회
  user.Name = "Updated Name"
  db.Save(&user) // UPDATE users SET name="Updated Name" WHERE id=1

  db.Model(&user).Update("age", 30) // UPDATE users SET age=30 WHERE id=1
  db.Model(&User{}).Where("age > ?", 25).Updates(User{Name: "Senior"})
  ```

---

#### 1.3.4 Delete (삭제)

- **단일 데이터 삭제**:
  - `Delete` 메서드는 구조체 또는 기본 키를 통해 데이터를 삭제합니다.
- **조건부 삭제**:
  - `Where` 메서드와 함께 사용해 조건에 맞는 데이터 삭제.
- **소프트 삭제**:
  - GORM은 기본적으로 소프트 삭제를 지원합니다. 모델에 `DeletedAt` 필드를 추가하면, 실제 삭제 대신 해당 필드에 시간이 기록됩니다.
- **예제**:
  ```go
  db.Delete(&user) // DELETE FROM users WHERE id=1

  db.Where("age < ?", 18).Delete(&User{}) // DELETE FROM users WHERE age < 18
  ```

---

### 추가 설명

1. **트랜잭션(Transaction)**
   - CRUD 작업은 `Begin`, `Commit`, `Rollback`을 통해 트랜잭션으로 묶을 수 있습니다.
   - 예제:
     ```go
     tx := db.Begin()
     if err := tx.Create(&user).Error; err != nil {
         tx.Rollback() // 작업 취소
         return
     }
     tx.Commit() // 작업 확정
     ```

2. **대량 작업(Bulk Operation)**
   - GORM은 대량 데이터 생성/업데이트를 위한 배치 작업을 지원합니다.
   - 예제:
     ```go
     users := []User{
         {Name: "User1", Age: 20},
         {Name: "User2", Age: 25},
     }
     db.Create(&users) // INSERT INTO users ...
     ```

